<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>pam_pkcs11: secutil.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_55f9682142a78e45196901be32452b47.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_782c1fcd7529e1a05f3f2af490691324.html">common</a>
  </div>
</div>
<div class="contents">
<h1>secutil.h</h1><a href="secutil_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* ***** BEGIN LICENSE BLOCK *****</span>
<a name="l00002"></a>00002 <span class="comment"> * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * The contents of this file are subject to the Mozilla Public License Version</span>
<a name="l00005"></a>00005 <span class="comment"> * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a name="l00006"></a>00006 <span class="comment"> * the License. You may obtain a copy of the License at</span>
<a name="l00007"></a>00007 <span class="comment"> * http://www.mozilla.org/MPL/</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a name="l00010"></a>00010 <span class="comment"> * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a name="l00011"></a>00011 <span class="comment"> * for the specific language governing rights and limitations under the</span>
<a name="l00012"></a>00012 <span class="comment"> * License.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * The Original Code is the Netscape security libraries.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * The Initial Developer of the Original Code is</span>
<a name="l00017"></a>00017 <span class="comment"> * Netscape Communications Corporation.</span>
<a name="l00018"></a>00018 <span class="comment"> * Portions created by the Initial Developer are Copyright (C) 1994-2000</span>
<a name="l00019"></a>00019 <span class="comment"> * the Initial Developer. All Rights Reserved.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * Contributor(s):</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * Alternatively, the contents of this file may be used under the terms of</span>
<a name="l00024"></a>00024 <span class="comment"> * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a name="l00025"></a>00025 <span class="comment"> * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a name="l00026"></a>00026 <span class="comment"> * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a name="l00027"></a>00027 <span class="comment"> * of those above. If you wish to allow use of your version of this file only</span>
<a name="l00028"></a>00028 <span class="comment"> * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a name="l00029"></a>00029 <span class="comment"> * use your version of this file under the terms of the MPL, indicate your</span>
<a name="l00030"></a>00030 <span class="comment"> * decision by deleting the provisions above and replace them with the notice</span>
<a name="l00031"></a>00031 <span class="comment"> * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a name="l00032"></a>00032 <span class="comment"> * the provisions above, a recipient may use your version of this file under</span>
<a name="l00033"></a>00033 <span class="comment"> * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment"> * ***** END LICENSE BLOCK ***** */</span>
<a name="l00036"></a>00036 <span class="preprocessor">#ifndef _SEC_UTIL_H_</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#define _SEC_UTIL_H_</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;seccomon.h&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;secitem.h&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;prerror.h&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="base64_8h.html">base64.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;key.h&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;secpkcs7.h&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;secasn1.h&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;secder.h&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="secutil_8h.html#a19d407bf61c7919a70a2846fd9cde1a7">00049</a> <span class="preprocessor">#define SEC_CT_PRIVATE_KEY              &quot;private-key&quot;</span>
<a name="l00050"></a><a class="code" href="secutil_8h.html#ae09169ed4d2f83fea605b871bbf8d0aa">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_CT_PUBLIC_KEY               &quot;public-key&quot;</span>
<a name="l00051"></a><a class="code" href="secutil_8h.html#a43f9dc21a6ca5fe58eaf9a5c95c79e08">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_CT_CERTIFICATE              &quot;certificate&quot;</span>
<a name="l00052"></a><a class="code" href="secutil_8h.html#a369c3b603df97b0d74d0e613967a8c07">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_CT_CERTIFICATE_REQUEST      &quot;certificate-request&quot;</span>
<a name="l00053"></a><a class="code" href="secutil_8h.html#ace31b1c5ef8a69b96f0e18de6e6f910f">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_CT_PKCS7                    &quot;pkcs7&quot;</span>
<a name="l00054"></a><a class="code" href="secutil_8h.html#aeea021d1f29af6c31a9fe15064cd1b06">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_CT_CRL                      &quot;crl&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="secutil_8h.html#ac861b4da4646056777f37a64c11acb35">00056</a> <span class="preprocessor">#define NS_CERTREQ_HEADER &quot;-----BEGIN NEW CERTIFICATE REQUEST-----&quot;</span>
<a name="l00057"></a><a class="code" href="secutil_8h.html#af75661099a6d5822f3403e55df0da427">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define NS_CERTREQ_TRAILER &quot;-----END NEW CERTIFICATE REQUEST-----&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a><a class="code" href="secutil_8h.html#a2b80169dd9035e5ae4ee5ba708a9ba7c">00059</a> <span class="preprocessor">#define NS_CERT_HEADER &quot;-----BEGIN CERTIFICATE-----&quot;</span>
<a name="l00060"></a><a class="code" href="secutil_8h.html#a425a1adbed4d9ddb2242e8a43febdfeb">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define NS_CERT_TRAILER &quot;-----END CERTIFICATE-----&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a><a class="code" href="secutil_8h.html#af76d39ca4df9b7a4d33e316631de6bf6">00062</a> <span class="preprocessor">#define NS_CRL_HEADER  &quot;-----BEGIN CRL-----&quot;</span>
<a name="l00063"></a><a class="code" href="secutil_8h.html#a2b0de608b028e9818f74c9a4141d5c6a">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define NS_CRL_TRAILER &quot;-----END CRL-----&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span>
<a name="l00065"></a>00065 <span class="comment">/* From libsec/pcertdb.c --- it&apos;s not declared in sec.h */</span>
<a name="l00066"></a>00066 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a04c3c24ae83609a3209f3594cc159abb">SEC_AddPermCertificate</a>(CERTCertDBHandle *handle,
<a name="l00067"></a>00067                 SECItem *derCert, <span class="keywordtype">char</span> *nickname, CERTCertTrust *trust);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="preprocessor">#ifdef SECUTIL_NEW</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="keyword">typedef</span> int (*<a class="code" href="secutil_8h.html#aad287034726f92bb545624c040eaf59a">SECU_PPFunc</a>)(PRFileDesc *out, SECItem *item,
<a name="l00072"></a>00072                            <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00073"></a>00073 <span class="preprocessor">#else</span>
<a name="l00074"></a><a class="code" href="secutil_8h.html#aad287034726f92bb545624c040eaf59a">00074</a> <span class="preprocessor"></span><span class="keyword">typedef</span> int (*<a class="code" href="secutil_8h.html#aad287034726f92bb545624c040eaf59a">SECU_PPFunc</a>)(FILE *out, SECItem *item, <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00075"></a>00075 <span class="preprocessor">#endif</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span>
<a name="l00077"></a><a class="code" href="structsecuPWData.html">00077</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00078"></a>00078     <span class="keyword">enum</span> {
<a name="l00079"></a><a class="code" href="structsecuPWData.html#a06fc87d81c62e9abb8790b6e5713c55baee7c552ff6c15567985e39ea917a83df">00079</a>         PW_NONE = 0,
<a name="l00080"></a><a class="code" href="structsecuPWData.html#a06fc87d81c62e9abb8790b6e5713c55ba08ba28e1910f2c3d066d784644ccc227">00080</a>         PW_FROMFILE = 1,
<a name="l00081"></a><a class="code" href="structsecuPWData.html#a06fc87d81c62e9abb8790b6e5713c55ba3804e300b7bdf0b6c1a4153b07cd30f6">00081</a>         PW_PLAINTEXT = 2,
<a name="l00082"></a><a class="code" href="structsecuPWData.html#a06fc87d81c62e9abb8790b6e5713c55ba9fdaa43d56cd1b37deb25241a5aa8ea0">00082</a>         PW_EXTERNAL = 3
<a name="l00083"></a>00083     } source;
<a name="l00084"></a><a class="code" href="structsecuPWData.html#a91a70b77df95bd8b0830b49a094c2acb">00084</a>     <span class="keywordtype">char</span> *data;
<a name="l00085"></a>00085 } <a class="code" href="structsecuPWData.html">secuPWData</a>;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">/*</span>
<a name="l00088"></a>00088 <span class="comment">** Change a password on a token, or initialize a token with a password</span>
<a name="l00089"></a>00089 <span class="comment">** if it does not already have one.</span>
<a name="l00090"></a>00090 <span class="comment">** Use passwd to send the password in plaintext, pwFile to specify a</span>
<a name="l00091"></a>00091 <span class="comment">** file containing the password, or NULL for both to prompt the user.</span>
<a name="l00092"></a>00092 <span class="comment">*/</span>
<a name="l00093"></a>00093 SECStatus <a class="code" href="secutil_8h.html#a603a1cf950763dc797dbf5c30f2dfee9">SECU_ChangePW</a>(PK11SlotInfo *slot, <span class="keywordtype">char</span> *passwd, <span class="keywordtype">char</span> *pwFile);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment">/*  These were stolen from the old sec.h... */</span>
<a name="l00096"></a>00096 <span class="comment">/*</span>
<a name="l00097"></a>00097 <span class="comment">** Check a password for legitimacy. Passwords must be at least 8</span>
<a name="l00098"></a>00098 <span class="comment">** characters long and contain one non-alphabetic. Return DSTrue if the</span>
<a name="l00099"></a>00099 <span class="comment">** password is ok, DSFalse otherwise.</span>
<a name="l00100"></a>00100 <span class="comment">*/</span>
<a name="l00101"></a>00101 <span class="keyword">extern</span> PRBool <a class="code" href="secutil_8h.html#a7319a56820a914f3235a7365963d0797">SEC_CheckPassword</a>(<span class="keywordtype">char</span> *password);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">/*</span>
<a name="l00104"></a>00104 <span class="comment">** Blind check of a password. Complement to SEC_CheckPassword which</span>
<a name="l00105"></a>00105 <span class="comment">** ignores length and content type, just retuning DSTrue is the password</span>
<a name="l00106"></a>00106 <span class="comment">** exists, DSFalse if NULL</span>
<a name="l00107"></a>00107 <span class="comment">*/</span>
<a name="l00108"></a>00108 <span class="keyword">extern</span> PRBool <a class="code" href="secutil_8h.html#a1308ab7e6fe17057d59d768ffa1451a8">SEC_BlindCheckPassword</a>(<span class="keywordtype">char</span> *password);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/*</span>
<a name="l00111"></a>00111 <span class="comment">** Get a password.</span>
<a name="l00112"></a>00112 <span class="comment">** First prompt with &quot;msg&quot; on &quot;out&quot;, then read the password from &quot;in&quot;.</span>
<a name="l00113"></a>00113 <span class="comment">** The password is then checked using &quot;chkpw&quot;.</span>
<a name="l00114"></a>00114 <span class="comment">*/</span>
<a name="l00115"></a>00115 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a85bb6afc6671a90db289bd3bdff20a45">SEC_GetPassword</a>(FILE *in, FILE *out, <span class="keywordtype">char</span> *msg,
<a name="l00116"></a>00116                                       PRBool (*chkpw)(<span class="keywordtype">char</span> *));
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#af3d74fe76212f2ea33a3e49865b2ba90">SECU_FilePasswd</a>(PK11SlotInfo *slot, PRBool retry, <span class="keywordtype">void</span> *arg);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a68dece8b21bf604ed8277a6cbcb4fc3b">SECU_GetPasswordString</a>(<span class="keywordtype">void</span> *arg, <span class="keywordtype">char</span> *prompt);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">/*</span>
<a name="l00123"></a>00123 <span class="comment">** Write a dongle password.</span>
<a name="l00124"></a>00124 <span class="comment">** Uses MD5 to hash constant system data (hostname, etc.), and then</span>
<a name="l00125"></a>00125 <span class="comment">** creates RC4 key to encrypt a password &quot;pw&quot; into a file &quot;fd&quot;.</span>
<a name="l00126"></a>00126 <span class="comment">*/</span>
<a name="l00127"></a>00127 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#ab6d6ca880b96157c4408e50796a4c612">SEC_WriteDongleFile</a>(<span class="keywordtype">int</span> fd, <span class="keywordtype">char</span> *pw);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">/*</span>
<a name="l00130"></a>00130 <span class="comment">** Get a dongle password.</span>
<a name="l00131"></a>00131 <span class="comment">** Uses MD5 to hash constant system data (hostname, etc.), and then</span>
<a name="l00132"></a>00132 <span class="comment">** creates RC4 key to decrypt and return a password from file &quot;fd&quot;.</span>
<a name="l00133"></a>00133 <span class="comment">*/</span>
<a name="l00134"></a>00134 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a1bb5e99fe424ac34dbef3d14312018ff">SEC_ReadDongleFile</a>(<span class="keywordtype">int</span> fd);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">/* End stolen headers */</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">/* Just sticks the two strings together with a / if needed */</span>
<a name="l00140"></a>00140 <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#ad569a1a8c9c4ebfb0ab46162f83e151d">SECU_AppendFilenameToDir</a>(<span class="keywordtype">char</span> *dir, <span class="keywordtype">char</span> *filename);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="comment">/* Returns result of getenv(&quot;SSL_DIR&quot;) or NULL */</span>
<a name="l00143"></a>00143 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a9b1adc0bd95de2c3057faf173e11657b">SECU_DefaultSSLDir</a>(<span class="keywordtype">void</span>);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">/*</span>
<a name="l00146"></a>00146 <span class="comment">** Should be called once during initialization to set the default</span>
<a name="l00147"></a>00147 <span class="comment">**    directory for looking for cert.db, key.db, and cert-nameidx.db files</span>
<a name="l00148"></a>00148 <span class="comment">** Removes trailing &apos;/&apos; in &apos;base&apos;</span>
<a name="l00149"></a>00149 <span class="comment">** If &apos;base&apos; is NULL, defaults to set to .netscape in home directory.</span>
<a name="l00150"></a>00150 <span class="comment">*/</span>
<a name="l00151"></a>00151 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#afc1cff122e5f806d76bc935b38968e30">SECU_ConfigDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* base);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">/*</span>
<a name="l00154"></a>00154 <span class="comment">** Basic callback function for SSL_GetClientAuthDataHook</span>
<a name="l00155"></a>00155 <span class="comment">*/</span>
<a name="l00156"></a>00156 <span class="keyword">extern</span> <span class="keywordtype">int</span>
<a name="l00157"></a>00157 <a class="code" href="secutil_8h.html#addaae7ab3be53e0b1370438ff52af1c2">SECU_GetClientAuthData</a>(<span class="keywordtype">void</span> *arg, PRFileDesc *fd,
<a name="l00158"></a>00158                        <span class="keyword">struct</span> CERTDistNamesStr *caNames,
<a name="l00159"></a>00159                        <span class="keyword">struct</span> CERTCertificateStr **pRetCert,
<a name="l00160"></a>00160                        <span class="keyword">struct</span> SECKEYPrivateKeyStr **pRetKey);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="comment">/* print out an error message */</span>
<a name="l00163"></a>00163 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a396b0859d4ffffdd351e9218da392f45">SECU_PrintError</a>(<span class="keywordtype">char</span> *progName, <span class="keywordtype">char</span> *msg, ...);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="comment">/* print out a system error message */</span>
<a name="l00166"></a>00166 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a395b7c351f326865be2fa09315e8f29c">SECU_PrintSystemError</a>(<span class="keywordtype">char</span> *progName, <span class="keywordtype">char</span> *msg, ...);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">/* Return informative error string */</span>
<a name="l00169"></a>00169 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="secutil_8h.html#ad8ff6d834a5e8c3bdf92a69c50049012">SECU_Strerror</a>(PRErrorCode errNum);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">/* print information about cert verification failure */</span>
<a name="l00172"></a>00172 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00173"></a>00173 <a class="code" href="secutil_8h.html#afbdcf6f130e235cb0b88922ad8f4b5d2">SECU_printCertProblems</a>(FILE *outfile, CERTCertDBHandle *handle,
<a name="l00174"></a>00174         CERTCertificate *<a class="code" href="SECerrs_8h.html#a849ee110484ddc0d2ec33426bc31f5fb">cert</a>, PRBool checksig,
<a name="l00175"></a>00175         SECCertificateUsage certUsage, <span class="keywordtype">void</span> *pinArg, PRBool verbose);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">/* Read the contents of a file into a SECItem */</span>
<a name="l00178"></a>00178 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a2fd49a0a9a464fe577909b7d546acfca">SECU_FileToItem</a>(SECItem *dst, PRFileDesc *src);
<a name="l00179"></a>00179 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a3e8aec03e4919ae9e7bfa29afbba3f4f">SECU_TextFileToItem</a>(SECItem *dst, PRFileDesc *src);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">/* Read in a DER from a file, may be ascii  */</span>
<a name="l00182"></a>00182 <span class="keyword">extern</span> SECStatus
<a name="l00183"></a>00183 <a class="code" href="secutil_8h.html#ae073aa1c382fb4ea9873c63ddef80be5">SECU_ReadDERFromFile</a>(SECItem *der, PRFileDesc *inFile, PRBool ascii);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="comment">/* Indent based on &quot;level&quot; */</span>
<a name="l00186"></a>00186 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a5015514d0cb3145fbe65bf9c858227f3">SECU_Indent</a>(FILE *out, <span class="keywordtype">int</span> level);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">/* Print integer value and hex */</span>
<a name="l00189"></a>00189 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a8f344c8c9a96850ebb5f2ffea2c03665">SECU_PrintInteger</a>(FILE *out, SECItem *i, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/* Print ObjectIdentifier symbolically */</span>
<a name="l00192"></a>00192 <span class="keyword">extern</span> SECOidTag <a class="code" href="secutil_8h.html#afbca683c9d64a206ec63899e56cce69f">SECU_PrintObjectID</a>(FILE *out, SECItem *oid, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">/* Print AlgorithmIdentifier symbolically */</span>
<a name="l00195"></a>00195 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#aea6ff7fbcc45a1c1ff624c4f7c56c0ce">SECU_PrintAlgorithmID</a>(FILE *out, SECAlgorithmID *a, <span class="keywordtype">char</span> *m,
<a name="l00196"></a>00196                                   <span class="keywordtype">int</span> level);
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="comment">/* Print SECItem as hex */</span>
<a name="l00199"></a>00199 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a6db15732ab6b1af497d6c03fc51246ce">SECU_PrintAsHex</a>(FILE *out, SECItem *i, <span class="keyword">const</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">/* dump a buffer in hex and ASCII */</span>
<a name="l00202"></a>00202 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a810abd03fb437b58c6ab306eb124ebbf">SECU_PrintBuf</a>(FILE *out, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg, <span class="keyword">const</span> <span class="keywordtype">void</span> *vp, <span class="keywordtype">int</span> len);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/*</span>
<a name="l00205"></a>00205 <span class="comment"> * Format and print the UTC Time &quot;t&quot;.  If the tag message &quot;m&quot; is not NULL,</span>
<a name="l00206"></a>00206 <span class="comment"> * do indent formatting based on &quot;level&quot; and add a newline afterward;</span>
<a name="l00207"></a>00207 <span class="comment"> * otherwise just print the formatted time string only.</span>
<a name="l00208"></a>00208 <span class="comment"> */</span>
<a name="l00209"></a>00209 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#ab4d762655f82dd9bfdcda53c6813c556">SECU_PrintUTCTime</a>(FILE *out, SECItem *t, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="comment">/*</span>
<a name="l00212"></a>00212 <span class="comment"> * Format and print the Generalized Time &quot;t&quot;.  If the tag message &quot;m&quot;</span>
<a name="l00213"></a>00213 <span class="comment"> * is not NULL, * do indent formatting based on &quot;level&quot; and add a newline</span>
<a name="l00214"></a>00214 <span class="comment"> * afterward; otherwise just print the formatted time string only.</span>
<a name="l00215"></a>00215 <span class="comment"> */</span>
<a name="l00216"></a>00216 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a059b76282bbf25a8237b78ff226f85c1">SECU_PrintGeneralizedTime</a>(FILE *out, SECItem *t, <span class="keywordtype">char</span> *m,
<a name="l00217"></a>00217                                       <span class="keywordtype">int</span> level);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="comment">/*</span>
<a name="l00220"></a>00220 <span class="comment"> * Format and print the UTC or Generalized Time &quot;t&quot;.  If the tag message</span>
<a name="l00221"></a>00221 <span class="comment"> * &quot;m&quot; is not NULL, do indent formatting based on &quot;level&quot; and add a newline</span>
<a name="l00222"></a>00222 <span class="comment"> * afterward; otherwise just print the formatted time string only.</span>
<a name="l00223"></a>00223 <span class="comment"> */</span>
<a name="l00224"></a>00224 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#ab83830093631433322e54b82f293491f">SECU_PrintTimeChoice</a>(FILE *out, SECItem *t, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">/* callback for listing certs through pkcs11 */</span>
<a name="l00227"></a>00227 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a02f9893fc2b3d785e09ba2226ff62354">SECU_PrintCertNickname</a>(CERTCertListNode* <a class="code" href="SECerrs_8h.html#a849ee110484ddc0d2ec33426bc31f5fb">cert</a>, <span class="keywordtype">void</span> *data);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="comment">/* Dump all certificate nicknames in a database */</span>
<a name="l00230"></a>00230 <span class="keyword">extern</span> SECStatus
<a name="l00231"></a>00231 <a class="code" href="secutil_8h.html#a8298926a304947ed5a8cdef3af7788a2">SECU_PrintCertificateNames</a>(CERTCertDBHandle *handle, PRFileDesc* out,
<a name="l00232"></a>00232                            PRBool sortByName, PRBool sortByTrust);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="comment">/* See if nickname already in database. Return 1 true, 0 false, -1 error */</span>
<a name="l00235"></a>00235 <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#a414e7b6131c5131ec63a2dcab21fb7d0">SECU_CheckCertNameExists</a>(CERTCertDBHandle *handle, <span class="keywordtype">char</span> *nickname);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="comment">/* Dump contents of cert req */</span>
<a name="l00238"></a>00238 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#a5b0feefd1b10eb1fb7fb5256ff9cd741">SECU_PrintCertificateRequest</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m,
<a name="l00239"></a>00239         <span class="keywordtype">int</span> level);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="comment">/* Dump contents of certificate */</span>
<a name="l00242"></a>00242 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#a39e483794a7e33711da057b1a973566b">SECU_PrintCertificate</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">/* print trust flags on a cert */</span>
<a name="l00245"></a>00245 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a90a0812af6efe565d85c96904a8faa9a">SECU_PrintTrustFlags</a>(FILE *out, CERTCertTrust *trust, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">/* Dump contents of public key */</span>
<a name="l00248"></a>00248 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#ab4c504a289433d7c10625322a246f5c7">SECU_PrintPublicKey</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="preprocessor">#ifdef HAVE_EPV_TEMPLATE</span>
<a name="l00251"></a>00251 <span class="preprocessor"></span><span class="comment">/* Dump contents of private key */</span>
<a name="l00252"></a>00252 <span class="keyword">extern</span> <span class="keywordtype">int</span> SECU_PrintPrivateKey(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00253"></a>00253 <span class="preprocessor">#endif</span>
<a name="l00254"></a>00254 <span class="preprocessor"></span>
<a name="l00255"></a>00255 <span class="comment">/* Print the MD5 and SHA1 fingerprints of a cert */</span>
<a name="l00256"></a>00256 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#aae4d20f541235b1470f0f64bebba2347">SECU_PrintFingerprints</a>(FILE *out, SECItem *derCert, <span class="keywordtype">char</span> *m,
<a name="l00257"></a>00257                                   <span class="keywordtype">int</span> level);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="comment">/* Pretty-print any PKCS7 thing */</span>
<a name="l00260"></a>00260 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#ae9383d145755c6ee447b3077accbd3b3">SECU_PrintPKCS7ContentInfo</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m,
<a name="l00261"></a>00261                                       <span class="keywordtype">int</span> level);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="comment">/* Init PKCS11 stuff */</span>
<a name="l00264"></a>00264 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#acc549cd228fbe5b1d461b494fb6b7a26">SECU_PKCS11Init</a>(PRBool readOnly);
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">/* Dump contents of signed data */</span>
<a name="l00267"></a>00267 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#a2eb512964394bc24173a29df7aed6d74">SECU_PrintSignedData</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level,
<a name="l00268"></a>00268                                 <a class="code" href="secutil_8h.html#aad287034726f92bb545624c040eaf59a">SECU_PPFunc</a> inner);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#a2b469e94e5de3e1cda9c0aa52dee80a2">SECU_PrintCrl</a>(FILE *out, SECItem *der, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00273"></a>00273 <a class="code" href="secutil_8h.html#a45ddecf11f21bba3ba37615d9a22a6d1">SECU_PrintCRLInfo</a>(FILE *out, CERTCrl *crl, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a6e6a0384a58c39fb51b595f4a1f03b25">SECU_PrintString</a>(FILE *out, SECItem *si, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00276"></a>00276 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a770e960cebf2f7c0eb2dfdb212f30c04">SECU_PrintAny</a>(FILE *out, SECItem *i, <span class="keywordtype">char</span> *m, <span class="keywordtype">int</span> level);
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a2eaff99fa77401ca4f63cef1484f8dba">SECU_PrintPolicy</a>(FILE *out, SECItem *value, <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00279"></a>00279 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a224c4a644e46bb13bb95e44140a8b016">SECU_PrintPrivKeyUsagePeriodExtension</a>(FILE *out, SECItem *value,
<a name="l00280"></a>00280                                  <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00281"></a>00281 
<a name="l00282"></a>00282 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#ae2f12187d1d3be5da2a5002be251b83f">SECU_PrintExtensions</a>(FILE *out, CERTCertExtension **extensions,
<a name="l00283"></a>00283                                  <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a6b298261592d3c2278c1258f3a8a36af">SECU_PrintName</a>(FILE *out, CERTName *name, <span class="keywordtype">char</span> *msg, <span class="keywordtype">int</span> level);
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="preprocessor">#ifdef SECU_GetPassword</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span><span class="comment">/* Convert a High public Key to a Low public Key */</span>
<a name="l00289"></a>00289 <span class="keyword">extern</span> SECKEYLowPublicKey *SECU_ConvHighToLow(SECKEYPublicKey *pubHighKey);
<a name="l00290"></a>00290 <span class="preprocessor">#endif</span>
<a name="l00291"></a>00291 <span class="preprocessor"></span>
<a name="l00292"></a>00292 <span class="keyword">extern</span> SECItem *<a class="code" href="secutil_8h.html#aa53948234b66c2b4506bdf6f91abb11f">SECU_GetPBEPassword</a>(<span class="keywordtype">void</span> *arg);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a8628d600abe081bda8928b9bb26cba66">SECU_GetModulePassword</a>(PK11SlotInfo *slot, PRBool retry, <span class="keywordtype">void</span> *arg);
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a5342b7a874de07aa38082540307adb71">DER_PrettyPrint</a>(FILE *out, SECItem *it, PRBool raw);
<a name="l00297"></a>00297 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#aa2ecc3e519faa5545e588cec9aea7bbe">SEC_Init</a>(<span class="keywordtype">void</span>);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#a2cbddf4f2da65d8aa5d269fe10c821d5">SECU_SECModDBName</a>(<span class="keywordtype">void</span>);
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a2d777b59a266e894044050764887abe2">SECU_PrintPRandOSError</a>(<span class="keywordtype">char</span> *progName);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#ab9e04da265402953b9f9287b6a1c5168">SECU_RegisterDynamicOids</a>(<span class="keywordtype">void</span>);
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="comment">/* Identifies hash algorithm tag by its string representation. */</span>
<a name="l00306"></a>00306 <span class="keyword">extern</span> SECOidTag <a class="code" href="secutil_8h.html#ab70432271c4beea05247da9e7f5b67cb">SECU_StringToSignatureAlgTag</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *alg);
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">/* Store CRL in output file or pk11 db. Also</span>
<a name="l00309"></a>00309 <span class="comment"> * encodes with base64 and exports to file if ascii flag is set</span>
<a name="l00310"></a>00310 <span class="comment"> * and file is not NULL. */</span>
<a name="l00311"></a>00311 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#ad0e01ebd3cea519b517ad61947bf2a6c">SECU_StoreCRL</a>(PK11SlotInfo *slot, SECItem *derCrl,
<a name="l00312"></a>00312                                PRFileDesc *outFile, <span class="keywordtype">int</span> ascii, <span class="keywordtype">char</span> *url);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="comment">/*</span>
<a name="l00316"></a>00316 <span class="comment">** DER sign a single block of data using private key encryption and the</span>
<a name="l00317"></a>00317 <span class="comment">** MD5 hashing algorithm. This routine first computes a digital signature</span>
<a name="l00318"></a>00318 <span class="comment">** using SEC_SignData, then wraps it with an CERTSignedData and then der</span>
<a name="l00319"></a>00319 <span class="comment">** encodes the result.</span>
<a name="l00320"></a>00320 <span class="comment">**      &quot;arena&quot; is the memory arena to use to allocate data from</span>
<a name="l00321"></a>00321 <span class="comment">**      &quot;sd&quot; returned CERTSignedData</span>
<a name="l00322"></a>00322 <span class="comment">**      &quot;result&quot; the final der encoded data (memory is allocated)</span>
<a name="l00323"></a>00323 <span class="comment">**      &quot;buf&quot; the input data to sign</span>
<a name="l00324"></a>00324 <span class="comment">**      &quot;len&quot; the amount of data to sign</span>
<a name="l00325"></a>00325 <span class="comment">**      &quot;pk&quot; the private key to encrypt with</span>
<a name="l00326"></a>00326 <span class="comment">*/</span>
<a name="l00327"></a>00327 <span class="keyword">extern</span> SECStatus <a class="code" href="secutil_8h.html#a50478a2f331616bc2e1d487954ea85fb">SECU_DerSignDataCRL</a>(PRArenaPool *arena, CERTSignedData *sd,
<a name="l00328"></a>00328                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len,
<a name="l00329"></a>00329                                      SECKEYPrivateKey *pk, SECOidTag algID);
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39">00331</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>  {
<a name="l00332"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39aae59036c8dbb63189164fa1559bb1c89">00332</a>     <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39aae59036c8dbb63189164fa1559bb1c89">noKeyFound</a> = 1,
<a name="l00333"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39a876b5c04e6c8745ab50da1e232b343d4">00333</a>     <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39a876b5c04e6c8745ab50da1e232b343d4">noSignatureMatch</a> = 2,
<a name="l00334"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39abd4dadfad06e2f921f79bb07adccf0ed">00334</a>     <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39abd4dadfad06e2f921f79bb07adccf0ed">failToEncode</a> = 3,
<a name="l00335"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39a16e508c3438e364a75d034b7d7dece60">00335</a>     <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39a16e508c3438e364a75d034b7d7dece60">failToSign</a> = 4,
<a name="l00336"></a><a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39ab2a4734afdbe9042fdd71ebd5b980035">00336</a>     <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39ab2a4734afdbe9042fdd71ebd5b980035">noMem</a> = 5
<a name="l00337"></a>00337 } <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39">SignAndEncodeFuncExitStat</a>;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 <span class="keyword">extern</span> SECStatus
<a name="l00340"></a>00340 <a class="code" href="secutil_8h.html#ac1965fc21e83fc4d3d54521508527065">SECU_SignAndEncodeCRL</a>(CERTCertificate *issuer, CERTSignedCrl *signCrl,
<a name="l00341"></a>00341                       SECOidTag hashAlgTag, <a class="code" href="secutil_8h.html#a0238bf0a2e613704a9aa4a87c2afac39">SignAndEncodeFuncExitStat</a> *resCode);
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 <span class="keyword">extern</span> SECStatus
<a name="l00344"></a>00344 <a class="code" href="secutil_8h.html#a60345ca6c7b0f1cab6cb46cd03d4d7c3">SECU_CopyCRL</a>(PRArenaPool *destArena, CERTCrl *destCrl, CERTCrl *srcCrl);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346 <span class="comment">/*</span>
<a name="l00347"></a>00347 <span class="comment">** Finds the crl Authority Key Id extension. Returns NULL if no such extension</span>
<a name="l00348"></a>00348 <span class="comment">** was found.</span>
<a name="l00349"></a>00349 <span class="comment">*/</span>
<a name="l00350"></a>00350 CERTAuthKeyID *
<a name="l00351"></a>00351 <a class="code" href="secutil_8h.html#a90411e0c25ebb7b8b51300155b307d61">SECU_FindCRLAuthKeyIDExten</a> (PRArenaPool *arena, CERTSignedCrl *crl);
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">/*</span>
<a name="l00354"></a>00354 <span class="comment"> * Find the issuer of a crl. Cert usage should be checked before signing a crl.</span>
<a name="l00355"></a>00355 <span class="comment"> */</span>
<a name="l00356"></a>00356 CERTCertificate *
<a name="l00357"></a>00357 <a class="code" href="secutil_8h.html#aa989b722efb055aa337ea3565e3c701f">SECU_FindCrlIssuer</a>(CERTCertDBHandle *dbHandle, SECItem* subject,
<a name="l00358"></a>00358                    CERTAuthKeyID* <span class="keywordtype">id</span>, PRTime validTime);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="comment">/* call back function used in encoding of an extension. Called from</span>
<a name="l00362"></a>00362 <span class="comment"> * SECU_EncodeAndAddExtensionValue */</span>
<a name="l00363"></a><a class="code" href="secutil_8h.html#a512bb52a7df3f0dd1a72452e7c9908c8">00363</a> <span class="keyword">typedef</span> SECStatus (* <a class="code" href="secutil_8h.html#a512bb52a7df3f0dd1a72452e7c9908c8">EXTEN_EXT_VALUE_ENCODER</a>) (PRArenaPool *extHandleArena,
<a name="l00364"></a>00364                                                <span class="keywordtype">void</span> *value, SECItem *encodedValue);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="comment">/* Encodes and adds extensions to the CRL or CRL entries. */</span>
<a name="l00367"></a>00367 SECStatus
<a name="l00368"></a>00368 <a class="code" href="secutil_8h.html#a5892e2059c49e29eb6079093a5a73f0e">SECU_EncodeAndAddExtensionValue</a>(PRArenaPool *arena, <span class="keywordtype">void</span> *extHandle,
<a name="l00369"></a>00369                                 <span class="keywordtype">void</span> *value, PRBool criticality, <span class="keywordtype">int</span> extenType,
<a name="l00370"></a>00370                                 <a class="code" href="secutil_8h.html#a512bb52a7df3f0dd1a72452e7c9908c8">EXTEN_EXT_VALUE_ENCODER</a> EncodeValueFn);
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="comment">/*</span>
<a name="l00374"></a>00374 <span class="comment"> *</span>
<a name="l00375"></a>00375 <span class="comment"> *  Utilities for parsing security tools command lines</span>
<a name="l00376"></a>00376 <span class="comment"> *</span>
<a name="l00377"></a>00377 <span class="comment"> */</span>
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="comment">/*  A single command flag  */</span>
<a name="l00380"></a><a class="code" href="structsecuCommandFlag.html">00380</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00381"></a><a class="code" href="structsecuCommandFlag.html#a11764cc96bb263d1f257bcc01205a787">00381</a>     <span class="keywordtype">char</span> flag;
<a name="l00382"></a><a class="code" href="structsecuCommandFlag.html#a088ed3252c5e13a0384ea419836bb067">00382</a>     PRBool needsArg;
<a name="l00383"></a><a class="code" href="structsecuCommandFlag.html#a4735e04e3a1e83180ddcee87243b6912">00383</a>     <span class="keywordtype">char</span> *arg;
<a name="l00384"></a><a class="code" href="structsecuCommandFlag.html#a3197a1fc9fe792b259a50ae48a06bf98">00384</a>     PRBool activated;
<a name="l00385"></a>00385 } <a class="code" href="structsecuCommandFlag.html">secuCommandFlag</a>;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="comment">/*  A full array of command/option flags  */</span>
<a name="l00388"></a><a class="code" href="structsecuCommand.html">00388</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00389"></a>00389 {
<a name="l00390"></a><a class="code" href="structsecuCommand.html#a9a58cf874769e6345e9a72a0ef9cb2e0">00390</a>     <span class="keywordtype">int</span> numCommands;
<a name="l00391"></a><a class="code" href="structsecuCommand.html#aa3174b58130e22f99a2289148aac2bc7">00391</a>     <span class="keywordtype">int</span> numOptions;
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="structsecuCommand.html#ae50b81e5e819edd215185bc07392a151">00393</a>     <a class="code" href="structsecuCommandFlag.html">secuCommandFlag</a> *commands;
<a name="l00394"></a><a class="code" href="structsecuCommand.html#aa31df13def1af9c07a305b7af9212509">00394</a>     <a class="code" href="structsecuCommandFlag.html">secuCommandFlag</a> *options;
<a name="l00395"></a>00395 } <a class="code" href="structsecuCommand.html">secuCommand</a>;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">/*  fill the &quot;arg&quot; and &quot;activated&quot; fields for each flag  */</span>
<a name="l00398"></a>00398 SECStatus
<a name="l00399"></a>00399 <a class="code" href="secutil_8h.html#a84661bdbda3350afa2a6acb69671c196">SECU_ParseCommandLine</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv, <span class="keywordtype">char</span> *progName, <a class="code" href="structsecuCommand.html">secuCommand</a> *cmd);
<a name="l00400"></a>00400 <span class="keywordtype">char</span> *
<a name="l00401"></a>00401 <a class="code" href="secutil_8h.html#a335b52005804013460a910b3c27e9adb">SECU_GetOptionArg</a>(<a class="code" href="structsecuCommand.html">secuCommand</a> *cmd, <span class="keywordtype">int</span> optionNum);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="comment">/*</span>
<a name="l00404"></a>00404 <span class="comment"> *</span>
<a name="l00405"></a>00405 <span class="comment"> *  Error messaging</span>
<a name="l00406"></a>00406 <span class="comment"> *</span>
<a name="l00407"></a>00407 <span class="comment"> */</span>
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">/* Return informative error string */</span>
<a name="l00410"></a>00410 <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#aee9168777215a655eac1ce4609fbf98f">SECU_ErrorString</a>(int16 err);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="comment">/* Return informative error string. Does not call XP_GetString */</span>
<a name="l00413"></a>00413 <span class="keywordtype">char</span> *<a class="code" href="secutil_8h.html#abd9fad7c16d3200b5ec9eb13e68ab85e">SECU_ErrorStringRaw</a>(int16 err);
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keywordtype">void</span> <a class="code" href="secutil_8h.html#a5d928b69750dc163158d166f1ed1fb73">printflags</a>(<span class="keywordtype">char</span> *trusts, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="preprocessor">#ifndef XP_UNIX</span>
<a name="l00418"></a>00418 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="secutil_8h.html#ad025df694f5c7bca7e3a93c55fbe2c6f">ffs</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i);
<a name="l00419"></a>00419 <span class="preprocessor">#endif</span>
<a name="l00420"></a>00420 <span class="preprocessor"></span>
<a name="l00421"></a>00421 <span class="preprocessor">#include &quot;secerr.h&quot;</span>
<a name="l00422"></a>00422 <span class="preprocessor">#include &quot;sslerr.h&quot;</span>
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="preprocessor">#endif </span><span class="comment">/* _SEC_UTIL_H_ */</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Sat Dec 19 14:31:08 2009 for pam_pkcs11 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
