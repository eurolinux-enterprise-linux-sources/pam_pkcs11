<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>pam_pkcs11: mapper.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_55f9682142a78e45196901be32452b47.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_ba07705465e8c8a06fa6b5f205305322.html">mappers</a>
  </div>
</div>
<div class="contents">
<h1>mapper.h File Reference</h1><code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;pwd.h&gt;</code><br/>
<code>#include &lt;../common/cert_st.h&gt;</code><br/>
<code>#include &quot;../scconf/scconf.h&quot;</code><br/>

<p><a href="mapper_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmapper__module__st.html">mapper_module_st</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure to be filled on mapper module initialization.  <a href="structmapper__module__st.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmapfile.html">mapfile</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This struct is used in processing map files a map file is a list of "key" " -&gt; " "value" text lines.  <a href="structmapfile.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a13bd5c2569e42f48a17ce7d7acd6607b">MAPPER_EXTERN</a>&nbsp;&nbsp;&nbsp;extern</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a791f7f44d4bc2b0fb3db279e4f5a8dc0">_DEFAULT_MAPPER_FIND_ENTRIES</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default macro for locate certificate entry.  <a href="#a791f7f44d4bc2b0fb3db279e4f5a8dc0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#ac77f111c63b7a5a1c75c81e5937da326">_DEFAULT_MAPPER_FIND_USER</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default macro for locating user.  <a href="#ac77f111c63b7a5a1c75c81e5937da326"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#ac8058aaca72c3f6db063e5128bf8eab1">_DEFAULT_MAPPER_MATCH_USER</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro for match mapper function.  <a href="#ac8058aaca72c3f6db063e5128bf8eab1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#afc62f3ec1bd2d9427511f13c525fc610">_DEFAULT_MAPPER_END</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro for de-initialization routine.  <a href="#afc62f3ec1bd2d9427511f13c525fc610"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#adb5e0d438bea160c5f0d35a8cdaf6466">_DEFAULT_MAPPER_INIT</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro for default init function.  <a href="#adb5e0d438bea160c5f0d35a8cdaf6466"></a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmapper__module__st.html">mapper_module_st</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a701fdce8eeaa5a0cadca3d947cb838eb">mapper_module</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure to be filled on mapper module initialization.  <a href="#a701fdce8eeaa5a0cadca3d947cb838eb"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapper__module__st.html">mapper_module</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#abd7e377bfc805aeac08054aa5ece69b9">mapper_module_init</a> (<a class="el" href="struct__scconf__block.html">scconf_block</a> *ctx, const char *mapper_name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize module and <a class="el" href="structmapper__module__st.html" title="Structure to be filled on mapper module initialization.">mapper_module_st</a> structure.  <a href="#abd7e377bfc805aeac08054aa5ece69b9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN struct <a class="el" href="structmapfile.html">mapfile</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#aff785dc94718a428e1ef46c35dc2dcfa">set_mapent</a> (const char *uri)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a mapper entry table.  <a href="#aff785dc94718a428e1ef46c35dc2dcfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a1478d4be0cc248ad061a36339c9b3daf">get_mapent</a> (struct <a class="el" href="structmapfile.html">mapfile</a> *mfile)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve next entry of given map file.  <a href="#a1478d4be0cc248ad061a36339c9b3daf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#abab71f0630103ff957b9e5d84a6105c0">end_mapent</a> (struct <a class="el" href="structmapfile.html">mapfile</a> *mfile)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release a mapentry structure.  <a href="#abab71f0630103ff957b9e5d84a6105c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a63c4a27f00025978b79902228ddffa4f">mapfile_find</a> (const char *file, char *key, int ignorecase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to map "key" to provided <a class="el" href="structmapfile.html" title="This struct is used in processing map files a map file is a list of &quot;key&quot;...">mapfile</a>.  <a href="#a63c4a27f00025978b79902228ddffa4f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a589ef6dd1c494a11afb251acec024d85">mapfile_match</a> (const char *file, char *key, const char *value, int ignorecase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to match provided key to provided name by mean of a <a class="el" href="structmapfile.html" title="This struct is used in processing map files a map file is a list of &quot;key&quot;...">mapfile</a>.  <a href="#a589ef6dd1c494a11afb251acec024d85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a11277748d021c9212e7460b90e10749c">search_pw_entry</a> (const char *item, int ignorecase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">find the user login that matches pw_name or pw_gecos with provided item  <a href="#a11277748d021c9212e7460b90e10749c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">MAPPER_EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a21892c500d029efa93208fd716de48c3">compare_pw_entry</a> (const char *item, struct passwd *pw, int ignorecase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if provided item matches pw_name or pw_gecos of provided password structure.  <a href="#a21892c500d029efa93208fd716de48c3"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="afc62f3ec1bd2d9427511f13c525fc610"></a><!-- doxytag: member="mapper.h::_DEFAULT_MAPPER_END" ref="afc62f3ec1bd2d9427511f13c525fc610" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_MAPPER_END</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> mapper_module_end(<span class="keywordtype">void</span> *context) {                          \
        free(context);                                                  \
        <span class="keywordflow">return</span>;                                                         \
}                                                                       \
</pre></div>
<p>Macro for de-initialization routine. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>Mapper context </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00216">216</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<a class="anchor" id="a791f7f44d4bc2b0fb3db279e4f5a8dc0"></a><!-- doxytag: member="mapper.h::_DEFAULT_MAPPER_FIND_ENTRIES" ref="a791f7f44d4bc2b0fb3db279e4f5a8dc0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_MAPPER_FIND_ENTRIES</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">char</span> ** mapper_find_entries(X509 *x509, <span class="keywordtype">void</span> *context) {         \
        <span class="keywordflow">return</span> NULL;                                                    \
}
</pre></div>
<p>Default macro for locate certificate entry. </p>
<p>Provided as sample for debugging, not for real user </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x509</em>&nbsp;</td><td>X509 Certificate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>Mapper context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>String array with up to 15 results or NULL if fail </dd></dl>

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00173">173</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac77f111c63b7a5a1c75c81e5937da326"></a><!-- doxytag: member="mapper.h::_DEFAULT_MAPPER_FIND_USER" ref="ac77f111c63b7a5a1c75c81e5937da326" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_MAPPER_FIND_USER</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">char</span> * mapper_find_user(X509 *x509,<span class="keywordtype">void</span> *context) {              \
        <span class="keywordflow">if</span> ( !x509 ) <span class="keywordflow">return</span> NULL;                                       \
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;nobody&quot;</span>;                                                \
}
</pre></div>
<p>Default macro for locating user. </p>
<p>Should not be used except for debugging, as allways returns "nobody" </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x509</em>&nbsp;</td><td>X509 Certificate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>Mapper context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Found user, or NULL </dd></dl>

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00186">186</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<a class="anchor" id="adb5e0d438bea160c5f0d35a8cdaf6466"></a><!-- doxytag: member="mapper.h::_DEFAULT_MAPPER_INIT" ref="adb5e0d438bea160c5f0d35a8cdaf6466" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_MAPPER_INIT</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="structmapper__module__st.html" title="Structure to be filled on mapper module initialization.">mapper_module</a>* <a class="code" href="mapper_8h.html#abd7e377bfc805aeac08054aa5ece69b9" title="Initialize module and mapper_module_st structure.">mapper_module_init</a>(<a class="code" href="struct__scconf__block.html">scconf_block</a> *blk,<span class="keyword">const</span> <span class="keywordtype">char</span> *name) { \
        <a class="code" href="structmapper__module__st.html" title="Structure to be filled on mapper module initialization.">mapper_module</a> *pt= malloc(<span class="keyword">sizeof</span> (<a class="code" href="structmapper__module__st.html" title="Structure to be filled on mapper module initialization.">mapper_module</a>));              \
        <span class="keywordflow">if</span> (!pt) <span class="keywordflow">return</span> NULL;                                           \
        pt-&gt;<a class="code" href="structmapper__module__st.html#a8f8f80d37794cde9472343e4487ba3eb" title="mapper name">name</a>    = name;                                             \
        pt-&gt;<a class="code" href="structmapper__module__st.html#ae376f130b17d169ee51be68077a89ed0" title="pointer to mapper local data">context</a> = NULL;                                             \
        pt-&gt;<a class="code" href="structmapper__module__st.html#abba81c977d8901de66b169a60d8481e1" title="mapper configuration block">block</a>   = blk;                                              \
        pt-&gt;<a class="code" href="structmapper__module__st.html#ab133ab6f78d4ef8149644d544f8d902c" title="debug level to set before call entry points">dbg_level</a>  = <a class="code" href="debug_8h.html#a0a71da33384f6806f93542b4cb95d7d2" title="get_debug_level() Returns the current debug level.">get_debug_level</a>();                             \
        pt-&gt;<a class="code" href="structmapper__module__st.html#a243a6cb3b1ff404e473d431be6cc5880" title="cert.">entries</a> = mapper_find_entries;                              \
        pt-&gt;<a class="code" href="structmapper__module__st.html#a45cb3d67c6aae40e79c7e07d830c4478" title="cert.">finder</a>  = mapper_find_user;                                 \
        pt-&gt;<a class="code" href="structmapper__module__st.html#a182609d9b64f223a3c9973fba94ca0b4" title="cert-to-login matcher">matcher</a> = mapper_match_user;                                \
        pt-&gt;<a class="code" href="structmapper__module__st.html#aa835e787ef360f3f94fc6ff15737e265" title="module de-initialization">deinit</a>  = mapper_module_end;                        \
        <span class="keywordflow">return</span> pt;                                                      \
}                                                                       \
</pre></div>
<p>Macro for default init function. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>blk</em>&nbsp;</td><td>Mapper Configuration file block </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>Name of this mapper </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to mapper_module data, else NULL NOTE: mapper module data MUST BE defined in module </dd></dl>

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00229">229</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac8058aaca72c3f6db063e5128bf8eab1"></a><!-- doxytag: member="mapper.h::_DEFAULT_MAPPER_MATCH_USER" ref="ac8058aaca72c3f6db063e5128bf8eab1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_MAPPER_MATCH_USER</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">int</span> mapper_match_user(X509 *x509, <span class="keyword">const</span> <span class="keywordtype">char</span> *login, <span class="keywordtype">void</span> *context) { \
        <span class="keywordtype">char</span> *username= mapper_find_user(x509,context);                         \
        <span class="keywordflow">if</span> (!x509) <span class="keywordflow">return</span> -1;                                           \
        <span class="keywordflow">if</span> (!login) <span class="keywordflow">return</span> -1;                                          \
        <span class="keywordflow">if</span> (!username) <span class="keywordflow">return</span> 0; <span class="comment">/*user not found*/</span>                     \
        <span class="keywordflow">if</span> ( ! strcmp(login,username) ) <span class="keywordflow">return</span> 1; <span class="comment">/* match user */</span>      \
        <span class="keywordflow">return</span> 0; <span class="comment">/* no match */</span>                                        \
}
</pre></div>
<p>Macro for match mapper function. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x509</em>&nbsp;</td><td>X509 Certificate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>login</em>&nbsp;</td><td>user to match, or null to find user that matches certificate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>Mapper context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on success; login points to matched user 0 on no match -1 on error </dd></dl>

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00202">202</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<a class="anchor" id="a13bd5c2569e42f48a17ce7d7acd6607b"></a><!-- doxytag: member="mapper.h::MAPPER_EXTERN" ref="a13bd5c2569e42f48a17ce7d7acd6607b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAPPER_EXTERN&nbsp;&nbsp;&nbsp;extern</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mapper_8h_source.html#l00096">96</a> of file <a class="el" href="mapper_8h_source.html">mapper.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a701fdce8eeaa5a0cadca3d947cb838eb"></a><!-- doxytag: member="mapper.h::mapper_module" ref="a701fdce8eeaa5a0cadca3d947cb838eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmapper__module__st.html">mapper_module_st</a>  <a class="el" href="structmapper__module__st.html">mapper_module</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Structure to be filled on mapper module initialization. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a21892c500d029efa93208fd716de48c3"></a><!-- doxytag: member="mapper.h::compare_pw_entry" ref="a21892c500d029efa93208fd716de48c3" args="(const char *item, struct passwd *pw, int ignorecase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN int compare_pw_entry </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct passwd *&nbsp;</td>
          <td class="paramname"> <em>pw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ignorecase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Test if provided item matches pw_name or pw_gecos of provided password structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>item</em>&nbsp;</td><td>String to be compared </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pw</em>&nbsp;</td><td>password entry to search into </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorecase</em>&nbsp;</td><td>Flag to check upper/lowercase in string comparisions </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on match, 0 on no match, -1 on error </dd></dl>

</div>
</div>
<a class="anchor" id="abab71f0630103ff957b9e5d84a6105c0"></a><!-- doxytag: member="mapper.h::end_mapent" ref="abab71f0630103ff957b9e5d84a6105c0" args="(struct mapfile *mfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN void end_mapent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmapfile.html">mapfile</a> *&nbsp;</td>
          <td class="paramname"> <em>mfile</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release a mapentry structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mfile</em>&nbsp;</td><td>Map file structure to be released </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1478d4be0cc248ad061a36339c9b3daf"></a><!-- doxytag: member="mapper.h::get_mapent" ref="a1478d4be0cc248ad061a36339c9b3daf" args="(struct mapfile *mfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN int get_mapent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmapfile.html">mapfile</a> *&nbsp;</td>
          <td class="paramname"> <em>mfile</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve next entry of given map file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mfile</em>&nbsp;</td><td>Map file entry pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on sucess, 0 on no more entries, -1 on error </dd></dl>

</div>
</div>
<a class="anchor" id="a63c4a27f00025978b79902228ddffa4f"></a><!-- doxytag: member="mapper.h::mapfile_find" ref="a63c4a27f00025978b79902228ddffa4f" args="(const char *file, char *key, int ignorecase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN char* mapfile_find </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ignorecase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Try to map "key" to provided <a class="el" href="structmapfile.html" title="This struct is used in processing map files a map file is a list of &quot;key&quot;...">mapfile</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>URL of map file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>String to be mapped </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorecase</em>&nbsp;</td><td>Flag to indicate upper/lowercase ignore in string compare </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>key on no match, else a <a class="el" href="strings_8h.html#a371a8cb3e3e24b794a5a871fff24242e" title="Duplicate a string.">clone_str()</a>'d of found mapping </dd></dl>

</div>
</div>
<a class="anchor" id="a589ef6dd1c494a11afb251acec024d85"></a><!-- doxytag: member="mapper.h::mapfile_match" ref="a589ef6dd1c494a11afb251acec024d85" args="(const char *file, char *key, const char *value, int ignorecase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN int mapfile_match </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ignorecase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Try to match provided key to provided name by mean of a <a class="el" href="structmapfile.html" title="This struct is used in processing map files a map file is a list of &quot;key&quot;...">mapfile</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>URL of map file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>String to be mapped </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>String to be matched against mapped result </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorecase</em>&nbsp;</td><td>Flag to indicate upper/lowercase ignore in string compare </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on match, 0 on no match, -1 on process error </dd></dl>

</div>
</div>
<a class="anchor" id="abd7e377bfc805aeac08054aa5ece69b9"></a><!-- doxytag: member="mapper.h::mapper_module_init" ref="abd7e377bfc805aeac08054aa5ece69b9" args="(scconf_block *ctx, const char *mapper_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapper__module__st.html">mapper_module</a>* mapper_module_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__scconf__block.html">scconf_block</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mapper_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize module and <a class="el" href="structmapper__module__st.html" title="Structure to be filled on mapper module initialization.">mapper_module_st</a> structure. </p>
<p>EVERY mapper module MUST provide and export this function if dinamycally linked </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>Pointer to related configuration file context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mapper_name</em>&nbsp;</td><td>Name of this mapper. Used for multi-mapper modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Pointer to a mapper_module structure, or NULL if failed </dd></dl>

</div>
</div>
<a class="anchor" id="a11277748d021c9212e7460b90e10749c"></a><!-- doxytag: member="mapper.h::search_pw_entry" ref="a11277748d021c9212e7460b90e10749c" args="(const char *item, int ignorecase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN char* search_pw_entry </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ignorecase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>find the user login that matches pw_name or pw_gecos with provided item </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>item</em>&nbsp;</td><td>Data to be searched from password database </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorecase</em>&nbsp;</td><td>Flag to check upper/lowercase in string comparisions </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>userlogin if match found, else NULL </dd></dl>

</div>
</div>
<a class="anchor" id="aff785dc94718a428e1ef46c35dc2dcfa"></a><!-- doxytag: member="mapper.h::set_mapent" ref="aff785dc94718a428e1ef46c35dc2dcfa" args="(const char *uri)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MAPPER_EXTERN struct <a class="el" href="structmapfile.html">mapfile</a>* set_mapent </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize a mapper entry table. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>Universal Resource Locator of the file to be mapped </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A <a class="el" href="structmapfile.html" title="This struct is used in processing map files a map file is a list of &quot;key&quot;...">mapfile</a> structure pointer or NULL </dd></dl>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Sat Dec 19 14:31:08 2009 for pam_pkcs11 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
